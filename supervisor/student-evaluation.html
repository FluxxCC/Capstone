<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OJTonTrack — Evaluation Form</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <main class="container centered">
      <div class="dashboard-main center-page">
        <div class="attendance-card" style="margin-top:0.75rem">
          <div style="display:flex;align-items:center;gap:8px;justify-content:flex-start;font-size:18px;font-weight:700;margin-bottom:8px">
            <a href="/supervisor/students-logs.html" style="font-size:12px;padding:6px 10px;border:1px solid #ccc;border-radius:999px;color:#111;text-decoration:none;background:#fff;display:inline-flex;align-items:center;gap:6px">⬅️ <span>Back</span></a>
            <span style="opacity:0.5">|</span>
            <div>Evaluation Form</div>
          </div>
          <div id="studentMeta" class="stat-label" style="margin-bottom:12px"></div>
          <div class="recent-scroll small" style="max-height:70vh;overflow-y:auto">

            <div class="recent-label">Performance Evaluation</div>

            <div style="font-weight:700;margin-top:8px;margin-bottom:4px">Quantity of Work</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers volume of assignment completed on time as compared with standards</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Is willing to replace an absent trainee if needed</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Quality of Work</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Serious in his/her work, accurate/enjoys what he/she is doing</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Follows good housekeeping even without order of the superior</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Job Competence</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers knowledge and skills required of the job</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Dependability</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers reliability in following instructions and procedure</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Can be depended upon when things go wrong</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Initiative</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Goes out of his/her way to perform tasks that will help the company even if not his/her responsibility</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Volunteers to do the job when needed</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Cooperativeness</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers how well he/she can get along with co-trainees</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Considers how well he/she can get along with superiors</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">3</td>
                  <td style="padding:6px">Considers how well he/she can get along with owners/managers</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Loyalty</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Protects the company</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Can be trusted</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">3</td>
                  <td style="padding:6px">Follows policies/objectives of the company</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Judgment</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers ability to grasp problems; can follow instructions</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Knows how to decide when needed</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Attendance</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Regular in work schedule; not absent without prior leave</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Always punctual; does not come in late</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Customer Service</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Practices good customer service</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">2</td>
                  <td style="padding:6px">Never argues/fights with customers</td>
                  <td style="padding:6px"></td>
                </tr>
                <tr>
                  <td style="padding:6px">3</td>
                  <td style="padding:6px">Greets customers</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

            <div style="font-weight:700;margin-top:12px;margin-bottom:4px">Overall Rating</div>
            <table style="width:100%;border-collapse:collapse">
              <thead>
                <tr>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Item</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Description</th>
                  <th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px">Grade</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="padding:6px">1</td>
                  <td style="padding:6px">Considers the practice as a whole</td>
                  <td style="padding:6px"></td>
                </tr>
              </tbody>
            </table>

          </div>
        </div>
      </div>
    </main>
    <nav class="student-nav">
      <div class="student-nav-inner">
        <a href="/supervisor/dashboard.html" aria-label="Home">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 10.5l9-7 9 7"/><path d="M5 11v9h14v-9"/></svg>
        </a>
        <a href="/supervisor/attendance.html" aria-label="Attendance">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4"/><path d="M8 2v4"/><path d="M3 10h18"/></svg>
        </a>
        <a href="/supervisor/students-logs.html" class="active" aria-label="Logs">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5V5a2 2 0 0 1 2-2h10"/><path d="M20 7v12a2 2 0 0 1-2 2H6"/><path d="M9 7h6"/><path d="M9 11h6"/><path d="M9 15h6"/></svg>
        </a>
        <a href="/supervisor/profile.html" aria-label="Profile">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="4"/><path d="M4 20c0-4 4-6 8-6s8 2 8 6"/></svg>
        </a>
      </div>
    </nav>
    <script>
      function authHeaders(json=false){ const t = sessionStorage.getItem('userToken'); const h = t ? { Authorization: 'Bearer ' + t } : {}; return json ? { 'Content-Type': 'application/json', ...h } : h; }
      async function ensureAuth() { const r = await fetch('/api/me', { headers: authHeaders() }); if (!r.ok) { window.location.replace('/index.html'); throw new Error('auth'); } return r.json(); }
      function getParam(name){ const u=new URL(window.location.href); return u.searchParams.get(name); }
      function initInputs(){ const bodies = Array.from(document.querySelectorAll('table tbody')); bodies.forEach(tb => { Array.from(tb.querySelectorAll('tr')).forEach(tr => { const cells = tr.querySelectorAll('td'); if (cells && cells.length >= 3) { const inp = document.createElement('input'); inp.type='number'; inp.min='0'; inp.max='100'; inp.step='1'; inp.placeholder='0-100'; inp.className='input'; inp.style.width='100%'; cells[2].innerHTML=''; cells[2].appendChild(inp); } }); }); }
      function collectData(){ const sections=[]; const content=document.querySelector('.attendance-card'); if (!content) return []; let current=''; Array.from(content.children).forEach(node => { const t=node && node.textContent ? String(node.textContent).trim() : ''; const isHeading = node && node.tagName==='DIV' && node.style && String(node.style.fontWeight||'')==='700'; if (isHeading) { current=t; sections.push({ name: current, rows: [] }); } else if (node && node.tagName==='TABLE') { const sec = sections[sections.length-1] || { name: '', rows: [] }; const rows = Array.from(node.querySelectorAll('tbody tr')).map(tr => { const cells=tr.querySelectorAll('td'); const item=cells[0]?cells[0].textContent.trim():''; const desc=cells[1]?cells[1].textContent.trim():''; const gradeInp=cells[2]?cells[2].querySelector('input'):null; const grade=gradeInp?Number(gradeInp.value||0):0; return { item, description: desc, grade }; }); sec.rows.push(...rows); if (!sections.includes(sec)) sections.push(sec); }
      }); return sections; }
      document.addEventListener('DOMContentLoaded', async function(){
        try { await ensureAuth(); } catch { return; }
        const id=getParam('id'); const meta=document.getElementById('studentMeta'); if (meta) { try { const r = await fetch('/api/supervisor/students', { headers: authHeaders() }); const j = await r.json().catch(()=>({})); const arr = r.ok && j.ok ? (Array.isArray(j.data)?j.data:[]) : []; const nameMap={}; for (const s of arr) { const sid=s.idNumber||s.idnumber||''; if (sid) nameMap[sid]=s.name||sid; } const name = nameMap[id] || id || ''; meta.textContent = name ? (name + ' (' + id + ')') : (id || ''); } catch { meta.textContent = id || ''; } }
        initInputs();
        const actionsWrap = document.createElement('div'); actionsWrap.style.display='grid'; actionsWrap.style.gridTemplateColumns='1fr'; actionsWrap.style.gap='8px'; actionsWrap.style.margin='12px 0'; const saveBtn=document.createElement('button'); saveBtn.className='role-button primary'; saveBtn.textContent='Save Evaluation'; saveBtn.addEventListener('click', async function(){ try { const st = await fetch('/api/evaluation/status/'+encodeURIComponent(id), { headers: authHeaders(), cache:'no-store' }); const sj = await st.json().catch(()=>({})); const enabled = !!(st.ok && sj.enabled); if (!enabled) { alert('Evaluation disabled by instructor'); return; } const form = collectData(); const r = await fetch('/api/evaluations', { method:'POST', headers: authHeaders(true), body: JSON.stringify({ idNumber: id, form }) }); const j = await r.json().catch(()=>({})); if (r.ok && j.ok) { alert('Saved'); } else { alert(j.error || 'Failed to save'); } } catch { alert('Network error'); } }); actionsWrap.appendChild(saveBtn); const card = document.querySelector('.attendance-card'); if (card) card.appendChild(actionsWrap);
      });
      (function(){ const nav = document.querySelector('.student-nav'); if (!nav) return; nav.classList.add('slideable'); let startY=null, lastY=null, moved=0; function start(e){ const t=e.touches?e.touches[0]:e; startY=t.clientY; lastY=startY; moved=0; } function move(e){ const t=e.touches?e.touches[0]:e; lastY=t.clientY; moved=lastY-startY; } function end(){ if (moved>30) { document.body.classList.add('nav-hidden'); } else if (moved<-30) { document.body.classList.remove('nav-hidden'); } else { document.body.classList.toggle('nav-hidden'); } startY=null; lastY=null; moved=0; } nav.addEventListener('touchstart', start, { passive:true }); nav.addEventListener('touchmove', move, { passive:true }); nav.addEventListener('touchend', end); nav.addEventListener('mousedown', start); nav.addEventListener('mousemove', function(e){ if (startY!==null) move(e); }); nav.addEventListener('mouseup', end); })();
    </script>
  </body>
</html>
